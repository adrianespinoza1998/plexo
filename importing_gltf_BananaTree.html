<!DOCTYPE html>
<html lang="en">
<head ng-app="app">
    <title>xeogl Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <script src="https://www.plexobuilding.com/plexo/xeogl-master/build/xeogl.js"></script>
    <script src="https://www.plexobuilding.com/plexo/xeogl-master/examples/js/models/glTFModel.js"></script>
	<script src="https://www.plexobuilding.com/plexo/xeogl-master/examples/js/annotations/pin.js"></script>
	<script src="https://www.plexobuilding.com/plexo/xeogl-master/examples/js/annotations/annotation.js"></script>

	<link href="https://www.plexobuilding.com/plexo/xeogl-master/examples/js/annotations/annotation-style.css" rel="stylesheet"/>

    <link href="https://www.plexobuilding.com/plexo/xeogl-master/examples/css/styles.css" rel="stylesheet"/>

<body ng-controller="homeCtrl" ng-model="actualizarCo2()">

<script>

    //var obtenerCo2=co2;

    var index=0;
    //var cantidadCo2=obtenerCo2[index];

   //console.log(cantidadCo2);

    //var cargarCo2=setInterval(actualizarCo2,60000);

    //---------------------------------------------------
    // Load the model
    //---------------------------------------------------

    var model = new xeogl.GLTFModel({
        src: "xeogl-master/examples/models/gltf/ejemplo 7/oficina.gltf"
    });

    var scene = xeogl.getDefaultScene();

    //-----------------------------------------------------------------------------------------------------
    // Camera animation and user control
    //-----------------------------------------------------------------------------------------------------

    var cameraControl = new xeogl.CameraControl(); // User camera control

    model.on("loaded", function () {

        // Position the camera to look at the model

        //var camera = model.scene.camera;
        //camera.eye = [-110.89, -44.85, 276.65];
        //camera.look = [-110.89, -44.85, -0.46];
        //camera.up = [0, 1, 0];
        //camera.zoom(1);

        // Create three annotations on meshes
        // within the model


        var a1 = new xeogl.Annotation({
            mesh: model.meshes[156], // Red handle
            primIndex: 125,
            bary: [0.3, 0.3, 0.3],
            occludable: true,
            glyph: "1",
            title: "Sala de estar",
            desc: "CO2:"+100,
            eye: [-10, -0.0, 10],
            look: [-2.0, -0.5, 0.5],
            up: [0.239, 0.948, -0.208],
            pinShown: true,
            labelShown: false
        });

        var cameraFlight = new xeogl.CameraFlightAnimation({
            duration: 1
        });

        var lastAnnotation;

        function pinClicked(annotation) {
            if (lastAnnotation) {
                annotation.labelShown = false;
            }
            annotation.labelShown = true;
            cameraFlight.flyTo(annotation);
            lastAnnotation = annotation;
        }

        a1.on("pinClicked", pinClicked);

        a1.on("localPos", function(localPos) {
            console.log("Local pos changed: " + JSON.stringify(localPos, null, "\t"));
        });
    });

    /*function actualizarCo2() {
        if (index == obtenerCo2.length-1) {
            clearInterval(cargarCo2);
        } else{
            index++;
            cantidadCo2=obtenerCo2[index];
            console.log(cantidadCo2);
            document.getElementsByClassName('xeogl-annotation-desc')[0].innerHTML='CO2:'+cantidadCo2;
        }
    }*/
</script>

</body>
</html>
